import { mock } from 'jest-mock-extended';
import { EidasValidationService } from '../../../../src/modules/eidasValidation/eidasValidation.service';
import { EidasValidatior } from '../../../../src/modules/shared/infrastructure/vidchainApi/eidasValidatior';
import { VerifiableCredentialDto } from '../../../../src/modules/eidasValidation/eidasValidation.controller';

describe('Eidas Validation service', () => {
  const eidasValidator = mock<EidasValidatior>();
  const eidasValidationService = new EidasValidationService(eidasValidator);

  it('should return not valid when there is no eidas cert in the Verifiable Credential', async () => {
    const verifiableCredentialDto: VerifiableCredentialDto = {
      verifiableCredential: {
        '@context': ['https://www.w3.org/2018/credentials/v1'],
        id: 'https://example.com/credential/2390',
        type: ['VerifiableCredential'],
        issuer: 'did:ethr:0x5C6Ce5fB9Ce616507017eaA190659E771Aa2919e',
        issuanceDate: '2023-02-07T15:54:27.000Z',
        credentialSubject: {
          test: 'test',
        },
        proof: {
          type: 'EcdsaSecp256k1Signature2019',
          created: '2023-02-07T15:54:27.000Z',
          proofPurpose: 'assertionMethod',
          verificationMethod:
            'did:ethr:0x5C6Ce5fB9Ce616507017eaA190659E771Aa2919e#keys-1',
          jws: 'eyJhbGciOiJFUzI1NksiLCJraWQiOiJkaWQ6ZXRocjoweDVDNkNlNWZCOUNlNjE2NTA3MDE3ZWFBMTkwNjU5RTc3MUFhMjkxOWUja2V5cy0xIiwidHlwIjoiSldUIn0.eyJpYXQiOjE2NzU3ODUyNjcsImlzcyI6ImRpZDpldGhyOjB4NUM2Q2U1ZkI5Q2U2MTY1MDcwMTdlYUExOTA2NTlFNzcxQWEyOTE5ZSIsInZjIjp7IkBjb250ZXh0IjpbImh0dHBzOi8vd3d3LnczLm9yZy8yMDE4L2NyZWRlbnRpYWxzL3YxIl0sImNyZWRlbnRpYWxTdWJqZWN0Ijp7ImNlcnRpZmljYXRlQmFzZTY0IjoiTUlJSHVqQ0NCYUtnQXdJQkFnSUlPbnFiV3o2T3VoTXdEUVlKS29aSWh2Y05BUUVMQlFBd2diZ3hDekFKQmdOVkJBWVRBa1ZUTVVRd1FnWURWUVFIRER0Q1lYSmpaV3h2Ym1FZ0tITmxaU0JqZFhKeVpXNTBJR0ZrWkhKbGMzTWdZWFFnZDNkM0xuVmhibUYwWVdOaExtTnZiUzloWkdSeVpYTnpLVEVXTUJRR0ExVUVDZ3dOVlVGT1FWUkJRMEVnVXk1QkxqRVZNQk1HQTFVRUN3d01WRk5RTFZWQlRrRlVRVU5CTVJvd0dBWURWUVFEREJGVlFVNUJWRUZEUVNCRFFURWdNakF4TmpFWU1CWUdBMVVFWVF3UFZrRlVSVk10UVRZMk56SXhORGs1TUI0WERUSXhNRFl3T1RFMk1URXdNRm9YRFRJek1EWXdPVEUyTVRFd01Gb3dkVEVMTUFrR0ExVUVCaE1DUlZNeEZ6QVZCZ05WQkFRTURrekRzM0JsZWlCRFlXSmxlbUZ6TVJFd0R3WURWUVFxREFoS2IyRnhkY090YmpFWU1CWUdBMVVFQlJNUFNVUkRSVk10TURNNU1EazFORFpaTVNBd0hnWURWUVFEREJkS2IyRnhkY090YmlCTXc3TndaWG9nUTJGaVpYcGhjekNDQVNJd0RRWUpLb1pJaHZjTkFRRUJCUUFEZ2dFUEFEQ0NBUW9DZ2dFQkFJWVJKU1FGa09sL2tHNldKUmQrYnJGdFBsY2NWN1QrL050K0xod3NUa21uaENnZXVBMDVnWnZWUHMydUQ4K3IvejhWTHV4ODNPa2pNaGM0cEpNQ09TOFBxaThlSzdnc3kwWU9oWHYzaGpqSzBtaTlPKzc5NHNYRldET1ZEY1dOelp1T3Zjek9oMHhTSTVhN3hMejFubDJmVWlOUkh3amZtTGhZVSs4SUtyWVlMTjZtWThPdms4SHYxZlRUbmZPRHFkWmFBSEtFdWxzQlhUcFlCaEFMZndRRHowTUpIMzE4TG5valdDRXprTEdCaWU5TzVoSHhDWmZtbE0vdTZCLytpbG9EL0dZVWtKVGV3Uy9heVovWkllSlBzdVo0RUt6ZnZUZ1MyMHFoa0ZaT1pOZ2dnQ2wvMUlVWFk5Vm1UZlZXaS9zNDIybEdNNXYyMGNCTGYrcnRWU3NDQXdFQUFhT0NBd2d3Z2dNRU1JSFhCZ2dyQmdFRkJRY0JBUVNCeWpDQnh6QlZCZ2dyQmdFRkJRY3dBb1pKYUhSMGNEb3ZMM2QzZHk1MVlXNWhkR0ZqWVM1amIyMHZjSFZpYkdsakwyUnZkMjVzYjJGa0wzUnpjRjlqWlhKMGFXWnBZMkYwWlhNdmMzVmliM0prYVc1aGRHVXhMbU55ZERBMkJnZ3JCZ0VGQlFjd0FZWXFhSFIwY0RvdkwyOWpjM0F4TG5WaGJtRjBZV05oTG1OdmJTOXdkV0pzYVdNdmNHdHBMMjlqYzNBdk1EWUdDQ3NHQVFVRkJ6QUJoaXBvZEhSd09pOHZiMk56Y0RJdWRXRnVZWFJoWTJFdVkyOXRMM0IxWW14cFl5OXdhMmt2YjJOemNDOHdIUVlEVlIwT0JCWUVGUCtXcnBwSUUwV2dJajJsWCtvelgyTGtrajZXTUF3R0ExVWRFd0VCL3dRQ01BQXdId1lEVlIwakJCZ3dGb0FVTFhIdnNHTi85ZjNnZ3lKRWYwUVFNSUZQVGVVd1ZRWUlLd1lCQlFVSEFRTUVTVEJITUFnR0JnUUFqa1lCQVRBTEJnWUVBSTVHQVFNQ0FROHdMZ1lHQkFDT1JnRUZEQ1JvZEhSd2N6b3ZMM2QzZHk1MVlXNWhkR0ZqWVM1amIyMHZjSFZpYkdsakwyTndjeTh3Z2FFR0ExVWRJQVNCbVRDQmxqQUpCZ2NFQUl2c1FBRUFNSUdJQmdzckJnRUVBWUx4TmdFQkFUQjVNREFHQ0NzR0FRVUZCd0lCRmlSb2RIUndjem92TDNkM2R5NTFZVzVoZEdGallTNWpiMjB2Y0hWaWJHbGpMMk53Y3k4d1JRWUlLd1lCQlFVSEFnSXdPUXczUTJWeWRHbG1hV05oWkc4Z1kzVmhiR2xtYVdOaFpHOGdaR1VnVUdWeWMyOXVZU0JHdzYxemFXTmhJR1Z1SUhOdlpuUjNZWEpsTGpDQmp3WURWUjBmQklHSE1JR0VNRUNnUHFBOGhqcG9kSFJ3T2k4dlkzSnNNUzUxWVc1aGRHRmpZUzVqYjIwdmNIVmliR2xqTDNCcmFTOWpjbXd2UTBFeGMzVmliM0prYVc1aFpHRXVZM0pzTUVDZ1BxQThoanBvZEhSd09pOHZZM0pzTWk1MVlXNWhkR0ZqWVM1amIyMHZjSFZpYkdsakwzQnJhUzlqY213dlEwRXhjM1ZpYjNKa2FXNWhaR0V1WTNKc01BNEdBMVVkRHdFQi93UUVBd0lGNERBZEJnTlZIU1VFRmpBVUJnZ3JCZ0VGQlFjREFnWUlLd1lCQlFVSEF3UXdIZ1lEVlIwUkJCY3dGWUVUYW14alpXeHFkWE56UUdkdFlXbHNMbU52YlRBTkJna3Foa2lHOXcwQkFRc0ZBQU9DQWdFQU1ydVQ2OWFNSDBlMWFyeDQxWEwxcllvOVBVSHlwWjcwc0Q5TDJVNlJyTDFRYzY1Q0k1clVEQUpmTUtSMmZzR2NvNExUMU1KeGtEZyt0WCtmem5jYm12NVpIeHNuaG8wK1MvRGRMai91TnRHblU5ZjZtQjlLNjJIZWVFN2E5Q0o4cTFHejhac2xXNXhRcnZ0R2x5RmxmUWc2dDljQTJHNkVtL29YVWZtdzBiN2E3UE1SRlpIeDJWdXdGNmlTSS8ycXFJWVBhbU5UZWJqb0xaRHNqMys2WVczUVI5YUFHWEFXbGc3TEpvbktuc3pzUVF3Nml5SGxyUENlbTliQThNZG5aSlJPaktobm5HOC9OTmhub1dzNFhCMHh3WjBQMGV5YVdOVGh2WkRCNndGNmJEWWg4MnhyZ3dqUnRoN0ZndlhYdUlEQkk4U05TVDFyYUgzMEUzbUx0djdJSVl4dGxNMUx2aXh5ZFFMb08wN2dWNVBhNmY4eTB3RWU5VG9GbVgvOVcyUmhDQW5mOExHMEx1Q3VEMWEvUFFzelk3TzV3YkRxemsyclM4NHVJcXJFQzhWenQvVU03SjZHSm9QVTN4bmQvWWV6TXE0bDk4UXN2RmdkbDhQUXVXei9Yd05ZKytla1FkMmVpS2tXTUF3dWpHSGtEZGJxVjhMeWxVNG1mTVRVSUxlZWRLd0MzckpYY1dqRGhIRlB6a01uWHI1dTdtYTIwSk9yRHlWY1UyMWVTS3J3V3lTWG1uVkVhbWpZeThNeHlIMDBsQ250b0lNYjgvYmFtZzV1aEhXL09vS0tXRWhtWUd0Y21SVVpvcjVKME81WnNadWpON1htQ1AyMlJZdVF0VkM0dEloTkxyN1FRQW83blZlVkJtdlVVazNCK0hKaDhEWHladmhPN05zPSIsImV4cGlyYXRpb25EYXRlIjoiMDkvMDYvMjAyMyAxODoxMTowMCIsImlkIjoiZGlkOmV0aHI6MHhFZUJCZERGQ2I1REYxMjFlMjFkNDUyNkNGNmI4NDdlRmFGYzNmZjgxIiwiaXNzdWVyTGVnYWxJRCI6IiIsImlzc3Vlck5hbWUiOiJVQU5BVEFDQSBDQTEgMjAxNiIsIm5hbWUiOiJKb2FxdcOtbiBMw7NwZXogQ2FiZXphcyIsInN1YmplY3RMZWdhbElEIjoiSURDRVMtMDM5MDk1NDZZIn0sImlkIjoiaHR0cHM6Ly9leGFtcGxlLmNvbS9jcmVkZW50aWFsLzIzOTAiLCJpc3N1ZXIiOiJkaWQ6ZXRocjoweDVDNkNlNWZCOUNlNjE2NTA3MDE3ZWFBMTkwNjU5RTc3MUFhMjkxOWUiLCJ0eXBlIjpbIlZlcmlmaWFibGVDcmVkZW50aWFsIiwiTGFyZ2VGYW1pbHlDYXJkIl19fQ.xAeMomAiC6q_m3pLKosUTZcWc9xDNx5dlN7uHGfGAbCfvACrn--XNXV2A9jauho4Wj1jvpEDLUILYk-064Xj1g',
        },
      },
    };
    eidasValidator.validate.mockImplementation();
    await expect(
      eidasValidationService.validate(verifiableCredentialDto),
    ).resolves.toEqual({
      valid: false,
      eidasCertInside: false,
    });
  });
  it('should validate a eidas cert from a Verifiable Credential', async () => {
    const verifiableCredentialDto: VerifiableCredentialDto = {
      verifiableCredential: {
        '@context': ['https://www.w3.org/2018/credentials/v1'],
        id: 'https://example.com/credential/2390',
        type: ['VerifiableCredential', 'LargeFamilyCard'],
        issuer: 'did:ethr:0x5C6Ce5fB9Ce616507017eaA190659E771Aa2919e',
        issuanceDate: '2023-02-07T15:54:27.000Z',
        credentialSubject: {
          certificateBase64:
            'MIIHujCCBaKgAwIBAgIIOnqbWz6OuhMwDQYJKoZIhvcNAQELBQAwgbgxCzAJBgNVBAYTAkVTMUQwQgYDVQQHDDtCYXJjZWxvbmEgKHNlZSBjdXJyZW50IGFkZHJlc3MgYXQgd3d3LnVhbmF0YWNhLmNvbS9hZGRyZXNzKTEWMBQGA1UECgwNVUFOQVRBQ0EgUy5BLjEVMBMGA1UECwwMVFNQLVVBTkFUQUNBMRowGAYDVQQDDBFVQU5BVEFDQSBDQTEgMjAxNjEYMBYGA1UEYQwPVkFURVMtQTY2NzIxNDk5MB4XDTIxMDYwOTE2MTEwMFoXDTIzMDYwOTE2MTEwMFowdTELMAkGA1UEBhMCRVMxFzAVBgNVBAQMDkzDs3BleiBDYWJlemFzMREwDwYDVQQqDAhKb2FxdcOtbjEYMBYGA1UEBRMPSURDRVMtMDM5MDk1NDZZMSAwHgYDVQQDDBdKb2FxdcOtbiBMw7NwZXogQ2FiZXphczCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAIYRJSQFkOl/kG6WJRd+brFtPlccV7T+/Nt+LhwsTkmnhCgeuA05gZvVPs2uD8+r/z8VLux83OkjMhc4pJMCOS8Pqi8eK7gsy0YOhXv3hjjK0mi9O+794sXFWDOVDcWNzZuOvczOh0xSI5a7xLz1nl2fUiNRHwjfmLhYU+8IKrYYLN6mY8Ovk8Hv1fTTnfODqdZaAHKEulsBXTpYBhALfwQDz0MJH318LnojWCEzkLGBie9O5hHxCZfmlM/u6B/+iloD/GYUkJTewS/ayZ/ZIeJPsuZ4EKzfvTgS20qhkFZOZNgggCl/1IUXY9VmTfVWi/s422lGM5v20cBLf+rtVSsCAwEAAaOCAwgwggMEMIHXBggrBgEFBQcBAQSByjCBxzBVBggrBgEFBQcwAoZJaHR0cDovL3d3dy51YW5hdGFjYS5jb20vcHVibGljL2Rvd25sb2FkL3RzcF9jZXJ0aWZpY2F0ZXMvc3Vib3JkaW5hdGUxLmNydDA2BggrBgEFBQcwAYYqaHR0cDovL29jc3AxLnVhbmF0YWNhLmNvbS9wdWJsaWMvcGtpL29jc3AvMDYGCCsGAQUFBzABhipodHRwOi8vb2NzcDIudWFuYXRhY2EuY29tL3B1YmxpYy9wa2kvb2NzcC8wHQYDVR0OBBYEFP+WrppIE0WgIj2lX+ozX2Lkkj6WMAwGA1UdEwEB/wQCMAAwHwYDVR0jBBgwFoAULXHvsGN/9f3ggyJEf0QQMIFPTeUwVQYIKwYBBQUHAQMESTBHMAgGBgQAjkYBATALBgYEAI5GAQMCAQ8wLgYGBACORgEFDCRodHRwczovL3d3dy51YW5hdGFjYS5jb20vcHVibGljL2Nwcy8wgaEGA1UdIASBmTCBljAJBgcEAIvsQAEAMIGIBgsrBgEEAYLxNgEBATB5MDAGCCsGAQUFBwIBFiRodHRwczovL3d3dy51YW5hdGFjYS5jb20vcHVibGljL2Nwcy8wRQYIKwYBBQUHAgIwOQw3Q2VydGlmaWNhZG8gY3VhbGlmaWNhZG8gZGUgUGVyc29uYSBGw61zaWNhIGVuIHNvZnR3YXJlLjCBjwYDVR0fBIGHMIGEMECgPqA8hjpodHRwOi8vY3JsMS51YW5hdGFjYS5jb20vcHVibGljL3BraS9jcmwvQ0Exc3Vib3JkaW5hZGEuY3JsMECgPqA8hjpodHRwOi8vY3JsMi51YW5hdGFjYS5jb20vcHVibGljL3BraS9jcmwvQ0Exc3Vib3JkaW5hZGEuY3JsMA4GA1UdDwEB/wQEAwIF4DAdBgNVHSUEFjAUBggrBgEFBQcDAgYIKwYBBQUHAwQwHgYDVR0RBBcwFYETamxjZWxqdXNzQGdtYWlsLmNvbTANBgkqhkiG9w0BAQsFAAOCAgEAMruT69aMH0e1arx41XL1rYo9PUHypZ70sD9L2U6RrL1Qc65CI5rUDAJfMKR2fsGco4LT1MJxkDg+tX+fzncbmv5ZHxsnho0+S/DdLj/uNtGnU9f6mB9K62HeeE7a9CJ8q1Gz8ZslW5xQrvtGlyFlfQg6t9cA2G6Em/oXUfmw0b7a7PMRFZHx2VuwF6iSI/2qqIYPamNTebjoLZDsj3+6YW3QR9aAGXAWlg7LJonKnszsQQw6iyHlrPCem9bA8MdnZJROjKhnnG8/NNhnoWs4XB0xwZ0P0eyaWNThvZDB6wF6bDYh82xrgwjRth7FgvXXuIDBI8SNST1raH30E3mLtv7IIYxtlM1LvixydQLoO07gV5Pa6f8y0wEe9ToFmX/9W2RhCAnf8LG0LuCuD1a/PQszY7O5wbDqzk2rS84uIqrEC8Vzt/UM7J6GJoPU3xnd/YezMq4l98QsvFgdl8PQuWz/XwNY++ekQd2eiKkWMAwujGHkDdbqV8LylU4mfMTUILeedKwC3rJXcWjDhHFPzkMnXr5u7ma20JOrDyVcU21eSKrwWySXmnVEamjYy8MxyH00lCntoIMb8/bamg5uhHW/OoKKWEhmYGtcmRUZor5J0O5ZsZujN7XmCP22RYuQtVC4tIhNLr7QQAo7nVeVBmvUUk3B+HJh8DXyZvhO7Ns=',
          expirationDate: '09/06/2023 18:11:00',
          id: 'did:ethr:0xEeBBdDFCb5DF121e21d4526CF6b847eFaFc3ff81',
          issuerLegalID: '',
          issuerName: 'UANATACA CA1 2016',
          name: 'Joaquín López Cabezas',
          subjectLegalID: 'IDCES-03909546Y',
        },
        proof: [
          {
            type: 'EcdsaSecp256k1Signature2019',
            created: '2023-02-07T15:54:27.000Z',
            proofPurpose: 'assertionMethod',
            verificationMethod:
              'did:ethr:0x5C6Ce5fB9Ce616507017eaA190659E771Aa2919e#keys-1',
            jws: 'eyJhbGciOiJFUzI1NksiLCJraWQiOiJkaWQ6ZXRocjoweDVDNkNlNWZCOUNlNjE2NTA3MDE3ZWFBMTkwNjU5RTc3MUFhMjkxOWUja2V5cy0xIiwidHlwIjoiSldUIn0.eyJpYXQiOjE2NzU3ODUyNjcsImlzcyI6ImRpZDpldGhyOjB4NUM2Q2U1ZkI5Q2U2MTY1MDcwMTdlYUExOTA2NTlFNzcxQWEyOTE5ZSIsInZjIjp7IkBjb250ZXh0IjpbImh0dHBzOi8vd3d3LnczLm9yZy8yMDE4L2NyZWRlbnRpYWxzL3YxIl0sImNyZWRlbnRpYWxTdWJqZWN0Ijp7ImNlcnRpZmljYXRlQmFzZTY0IjoiTUlJSHVqQ0NCYUtnQXdJQkFnSUlPbnFiV3o2T3VoTXdEUVlKS29aSWh2Y05BUUVMQlFBd2diZ3hDekFKQmdOVkJBWVRBa1ZUTVVRd1FnWURWUVFIRER0Q1lYSmpaV3h2Ym1FZ0tITmxaU0JqZFhKeVpXNTBJR0ZrWkhKbGMzTWdZWFFnZDNkM0xuVmhibUYwWVdOaExtTnZiUzloWkdSeVpYTnpLVEVXTUJRR0ExVUVDZ3dOVlVGT1FWUkJRMEVnVXk1QkxqRVZNQk1HQTFVRUN3d01WRk5RTFZWQlRrRlVRVU5CTVJvd0dBWURWUVFEREJGVlFVNUJWRUZEUVNCRFFURWdNakF4TmpFWU1CWUdBMVVFWVF3UFZrRlVSVk10UVRZMk56SXhORGs1TUI0WERUSXhNRFl3T1RFMk1URXdNRm9YRFRJek1EWXdPVEUyTVRFd01Gb3dkVEVMTUFrR0ExVUVCaE1DUlZNeEZ6QVZCZ05WQkFRTURrekRzM0JsZWlCRFlXSmxlbUZ6TVJFd0R3WURWUVFxREFoS2IyRnhkY090YmpFWU1CWUdBMVVFQlJNUFNVUkRSVk10TURNNU1EazFORFpaTVNBd0hnWURWUVFEREJkS2IyRnhkY090YmlCTXc3TndaWG9nUTJGaVpYcGhjekNDQVNJd0RRWUpLb1pJaHZjTkFRRUJCUUFEZ2dFUEFEQ0NBUW9DZ2dFQkFJWVJKU1FGa09sL2tHNldKUmQrYnJGdFBsY2NWN1QrL050K0xod3NUa21uaENnZXVBMDVnWnZWUHMydUQ4K3IvejhWTHV4ODNPa2pNaGM0cEpNQ09TOFBxaThlSzdnc3kwWU9oWHYzaGpqSzBtaTlPKzc5NHNYRldET1ZEY1dOelp1T3Zjek9oMHhTSTVhN3hMejFubDJmVWlOUkh3amZtTGhZVSs4SUtyWVlMTjZtWThPdms4SHYxZlRUbmZPRHFkWmFBSEtFdWxzQlhUcFlCaEFMZndRRHowTUpIMzE4TG5valdDRXprTEdCaWU5TzVoSHhDWmZtbE0vdTZCLytpbG9EL0dZVWtKVGV3Uy9heVovWkllSlBzdVo0RUt6ZnZUZ1MyMHFoa0ZaT1pOZ2dnQ2wvMUlVWFk5Vm1UZlZXaS9zNDIybEdNNXYyMGNCTGYrcnRWU3NDQXdFQUFhT0NBd2d3Z2dNRU1JSFhCZ2dyQmdFRkJRY0JBUVNCeWpDQnh6QlZCZ2dyQmdFRkJRY3dBb1pKYUhSMGNEb3ZMM2QzZHk1MVlXNWhkR0ZqWVM1amIyMHZjSFZpYkdsakwyUnZkMjVzYjJGa0wzUnpjRjlqWlhKMGFXWnBZMkYwWlhNdmMzVmliM0prYVc1aGRHVXhMbU55ZERBMkJnZ3JCZ0VGQlFjd0FZWXFhSFIwY0RvdkwyOWpjM0F4TG5WaGJtRjBZV05oTG1OdmJTOXdkV0pzYVdNdmNHdHBMMjlqYzNBdk1EWUdDQ3NHQVFVRkJ6QUJoaXBvZEhSd09pOHZiMk56Y0RJdWRXRnVZWFJoWTJFdVkyOXRMM0IxWW14cFl5OXdhMmt2YjJOemNDOHdIUVlEVlIwT0JCWUVGUCtXcnBwSUUwV2dJajJsWCtvelgyTGtrajZXTUF3R0ExVWRFd0VCL3dRQ01BQXdId1lEVlIwakJCZ3dGb0FVTFhIdnNHTi85ZjNnZ3lKRWYwUVFNSUZQVGVVd1ZRWUlLd1lCQlFVSEFRTUVTVEJITUFnR0JnUUFqa1lCQVRBTEJnWUVBSTVHQVFNQ0FROHdMZ1lHQkFDT1JnRUZEQ1JvZEhSd2N6b3ZMM2QzZHk1MVlXNWhkR0ZqWVM1amIyMHZjSFZpYkdsakwyTndjeTh3Z2FFR0ExVWRJQVNCbVRDQmxqQUpCZ2NFQUl2c1FBRUFNSUdJQmdzckJnRUVBWUx4TmdFQkFUQjVNREFHQ0NzR0FRVUZCd0lCRmlSb2RIUndjem92TDNkM2R5NTFZVzVoZEdGallTNWpiMjB2Y0hWaWJHbGpMMk53Y3k4d1JRWUlLd1lCQlFVSEFnSXdPUXczUTJWeWRHbG1hV05oWkc4Z1kzVmhiR2xtYVdOaFpHOGdaR1VnVUdWeWMyOXVZU0JHdzYxemFXTmhJR1Z1SUhOdlpuUjNZWEpsTGpDQmp3WURWUjBmQklHSE1JR0VNRUNnUHFBOGhqcG9kSFJ3T2k4dlkzSnNNUzUxWVc1aGRHRmpZUzVqYjIwdmNIVmliR2xqTDNCcmFTOWpjbXd2UTBFeGMzVmliM0prYVc1aFpHRXVZM0pzTUVDZ1BxQThoanBvZEhSd09pOHZZM0pzTWk1MVlXNWhkR0ZqWVM1amIyMHZjSFZpYkdsakwzQnJhUzlqY213dlEwRXhjM1ZpYjNKa2FXNWhaR0V1WTNKc01BNEdBMVVkRHdFQi93UUVBd0lGNERBZEJnTlZIU1VFRmpBVUJnZ3JCZ0VGQlFjREFnWUlLd1lCQlFVSEF3UXdIZ1lEVlIwUkJCY3dGWUVUYW14alpXeHFkWE56UUdkdFlXbHNMbU52YlRBTkJna3Foa2lHOXcwQkFRc0ZBQU9DQWdFQU1ydVQ2OWFNSDBlMWFyeDQxWEwxcllvOVBVSHlwWjcwc0Q5TDJVNlJyTDFRYzY1Q0k1clVEQUpmTUtSMmZzR2NvNExUMU1KeGtEZyt0WCtmem5jYm12NVpIeHNuaG8wK1MvRGRMai91TnRHblU5ZjZtQjlLNjJIZWVFN2E5Q0o4cTFHejhac2xXNXhRcnZ0R2x5RmxmUWc2dDljQTJHNkVtL29YVWZtdzBiN2E3UE1SRlpIeDJWdXdGNmlTSS8ycXFJWVBhbU5UZWJqb0xaRHNqMys2WVczUVI5YUFHWEFXbGc3TEpvbktuc3pzUVF3Nml5SGxyUENlbTliQThNZG5aSlJPaktobm5HOC9OTmhub1dzNFhCMHh3WjBQMGV5YVdOVGh2WkRCNndGNmJEWWg4MnhyZ3dqUnRoN0ZndlhYdUlEQkk4U05TVDFyYUgzMEUzbUx0djdJSVl4dGxNMUx2aXh5ZFFMb08wN2dWNVBhNmY4eTB3RWU5VG9GbVgvOVcyUmhDQW5mOExHMEx1Q3VEMWEvUFFzelk3TzV3YkRxemsyclM4NHVJcXJFQzhWenQvVU03SjZHSm9QVTN4bmQvWWV6TXE0bDk4UXN2RmdkbDhQUXVXei9Yd05ZKytla1FkMmVpS2tXTUF3dWpHSGtEZGJxVjhMeWxVNG1mTVRVSUxlZWRLd0MzckpYY1dqRGhIRlB6a01uWHI1dTdtYTIwSk9yRHlWY1UyMWVTS3J3V3lTWG1uVkVhbWpZeThNeHlIMDBsQ250b0lNYjgvYmFtZzV1aEhXL09vS0tXRWhtWUd0Y21SVVpvcjVKME81WnNadWpON1htQ1AyMlJZdVF0VkM0dEloTkxyN1FRQW83blZlVkJtdlVVazNCK0hKaDhEWHladmhPN05zPSIsImV4cGlyYXRpb25EYXRlIjoiMDkvMDYvMjAyMyAxODoxMTowMCIsImlkIjoiZGlkOmV0aHI6MHhFZUJCZERGQ2I1REYxMjFlMjFkNDUyNkNGNmI4NDdlRmFGYzNmZjgxIiwiaXNzdWVyTGVnYWxJRCI6IiIsImlzc3Vlck5hbWUiOiJVQU5BVEFDQSBDQTEgMjAxNiIsIm5hbWUiOiJKb2FxdcOtbiBMw7NwZXogQ2FiZXphcyIsInN1YmplY3RMZWdhbElEIjoiSURDRVMtMDM5MDk1NDZZIn0sImlkIjoiaHR0cHM6Ly9leGFtcGxlLmNvbS9jcmVkZW50aWFsLzIzOTAiLCJpc3N1ZXIiOiJkaWQ6ZXRocjoweDVDNkNlNWZCOUNlNjE2NTA3MDE3ZWFBMTkwNjU5RTc3MUFhMjkxOWUiLCJ0eXBlIjpbIlZlcmlmaWFibGVDcmVkZW50aWFsIiwiTGFyZ2VGYW1pbHlDYXJkIl19fQ.xAeMomAiC6q_m3pLKosUTZcWc9xDNx5dlN7uHGfGAbCfvACrn--XNXV2A9jauho4Wj1jvpEDLUILYk-064Xj1g',
          },
          {
            type: 'CAdESRSASignature2020',
            created: '2023-02-07T15:54:28Z',
            proofPurpose: 'assertionMethod',
            verificationMethod:
              'did:ethr:0x5C6Ce5fB9Ce616507017eaA190659E771Aa2919e#MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAziPjJZebqdAhKZI0zUqd7439PGAlGY/MEIYl/hd0f3paG6UNcnQr74mzkOsJblSTcfzWCPefqWDQ1L/jQ0Iz1gR47I5l+sW7bBRivs1iWON6bcRXuitmVXFJPTl+R6x5vcEcOYlrKq0Fo9fEgbHb5i7Hjl0nWSOLcFsFkgSXfgmv3eI4uYlQyqs6qyICpApcWrijjIRlBlhsbv6Oz0Z8yi0v8FvgEy7Dq40yIoY3IWEGB8GNgi/E3lnLSRsGvzTWT5SXuurSzxrArh2okcNwtAt9DRF3VtMBO701zC2rfI65VyoIKX4QvctGiLSNOSYajDJ9Jg6GjnlE/US0Z6hyDwIDAQAB',
            cades:
              '-----BEGIN PKCS7-----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-----END PKCS7-----',
          },
        ],
      },
    };
    const expectedBase64Certificate =
      'LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tDQpNSUlIaFRDQ0JtMmdBd0lCQWdJUVNuS1BwZ0NRWUlSZmlxMG5SN0hHb3pBTkJna3Foa2lHOXcwQkFRc0ZBREJIDQpNUXN3Q1FZRFZRUUdFd0pGVXpFUk1BOEdBMVVFQ2d3SVJrNU5WQzFTUTAweEpUQWpCZ05WQkFzTUhFRkRJRU52DQpiWEJ2Ym1WdWRHVnpJRWx1Wm05eWJjT2hkR2xqYjNNd0hoY05NakF4TURFM01EZ3pOalUxV2hjTk1qTXhNREUzDQpNRGd6TmpVMFdqQ0JvREVMTUFrR0ExVUVCaE1DUlZNeER6QU5CZ05WQkFjTUJrMUJSRkpKUkRFWk1CY0dBMVVFDQpDZ3dRUms1TlZDMVNRMDBnVUZKVlJVSkJVekVPTUF3R0ExVUVDd3dGUTBWU1JWTXhFakFRQmdOVkJBVVRDVkV3DQpNREF3TURBd1NqRVlNQllHQTFVRVlRd1BWa0ZVUlZNdFVUQXdNREF3TURCS01TY3dKUVlEVlFRRERCNVRSVXhNDQpUeUJEVDAxUVQwNUZUbFJGSUZCU1ZVVkNRVk1nUlVsRVFWTXdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCDQpEd0F3Z2dFS0FvSUJBUURPSStNbGw1dXAwQ0Vwa2pUTlNwM3ZqZjA4WUNVWmo4d1FoaVgrRjNSL2Vsb2JwUTF5DQpkQ3Z2aWJPUTZ3bHVWSk54L05ZSTk1K3BZTkRVditORFFqUFdCSGpzam1YNnhidHNGR0sreldKWTQzcHR4RmU2DQpLMlpWY1VrOU9YNUhySG05d1J3NWlXc3FyUVdqMThTQnNkdm1Mc2VPWFNkWkk0dHdXd1dTQkpkK0NhL2Q0amk1DQppVkRLcXpxcklnS2tDbHhhdUtPTWhHVUdXR3h1L283UFJuektMUy93VytBVExzT3JqVElpaGpjaFlRWUh3WTJDDQpMOFRlV2N0Skd3YS9OTlpQbEplNjZ0TFBHc0N1SGFpUnczQzBDMzBORVhkVzB3RTd2VFhNTGF0OGpybFhLZ2dwDQpmaEM5eTBhSXRJMDVKaHFNTW4wbURvYU9lVVQ5UkxSbnFISVBBZ01CQUFHamdnUVJNSUlFRFRBTUJnTlZIUk1CDQpBZjhFQWpBQU1JR0JCZ2dyQmdFRkJRY0JBUVIxTUhNd093WUlLd1lCQlFVSE1BR0dMMmgwZEhBNkx5OXZZM053DQpZMjl0Y0M1alpYSjBMbVp1YlhRdVpYTXZiMk56Y0M5UFkzTndVbVZ6Y0c5dVpHVnlNRFFHQ0NzR0FRVUZCekFDDQpoaWhvZEhSd09pOHZkM2QzTG1ObGNuUXVabTV0ZEM1bGN5OWpaWEowY3k5QlEwTlBUVkF1WTNKME1JSUJOQVlEDQpWUjBnQklJQkt6Q0NBU2N3Z2dFWUJnb3JCZ0VFQWF4bUF3a1RNSUlCQ0RBcEJnZ3JCZ0VGQlFjQ0FSWWRhSFIwDQpjRG92TDNkM2R5NWpaWEowTG1adWJYUXVaWE12WkhCamN5OHdnZG9HQ0NzR0FRVUZCd0lDTUlITkRJSEtRMlZ5DQpkR2xtYVdOaFpHOGdZM1ZoYkdsbWFXTmhaRzhnWkdVZ2MyVnNiRzhnWld4bFkzUnl3N051YVdOdklITmxaOE82DQpiaUJ5Wldkc1lXMWxiblJ2SUdWMWNtOXdaVzhnWlVsRVFWTXVJRk4xYW1WMGJ5QmhJR3hoY3lCamIyNWthV05wDQpiMjVsY3lCa1pTQjFjMjhnWlhod2RXVnpkR0Z6SUdWdUlHeGhJRVJRUXlCa1pTQkdUazFVTFZKRFRTQmpiMjRnDQpUa2xHT2lCUk1qZ3lOakF3TkMxS0lDaERMMHB2Y21kbElFcDFZVzRnTVRBMkxUSTRNREE1TFUxaFpISnBaQzFGDQpjM0JodzdGaEtUQUpCZ2NFQUl2c1FBRUJNRHdHQTFVZEVRUTFNRE9rTVRBdk1TMHdLd1lKS3dZQkJBR3NaZ0VJDQpEQjVUUlV4TVR5QkRUMDFRVDA1RlRsUkZJRkJTVlVWQ1FWTWdSVWxFUVZNd0hRWURWUjBsQkJZd0ZBWUlLd1lCDQpCUVVIQXdJR0NDc0dBUVVGQndNRU1BNEdBMVVkRHdFQi93UUVBd0lGNERBZEJnTlZIUTRFRmdRVUwrN1NFUi9yDQpqWWJ0QVNHT3VIbnlzSVFhVm5Nd2diQUdDQ3NHQVFVRkJ3RURCSUdqTUlHZ01BZ0dCZ1FBamtZQkFUQUxCZ1lFDQpBSTVHQVFNQ0FROHdFd1lHQkFDT1JnRUdNQWtHQndRQWprWUJCZ0l3Y2dZR0JBQ09SZ0VGTUdnd01oWXNhSFIwDQpjSE02THk5M2QzY3VZMlZ5ZEM1bWJtMTBMbVZ6TDNCa2N5OVFSRk5mUTA5TlVGOWxjeTV3WkdZVEFtVnpNRElXDQpMR2gwZEhCek9pOHZkM2QzTG1ObGNuUXVabTV0ZEM1bGN5OXdaSE12VUVSVFgwTlBUVkJmWlc0dWNHUm1Fd0psDQpiakFmQmdOVkhTTUVHREFXZ0JRWitGZ3ZGTmFtekpzRW1BZ05UTmVyQUtlRFpUQ0I0QVlEVlIwZkJJSFlNSUhWDQpNSUhTb0lIUG9JSE1ob0dlYkdSaGNEb3ZMMnhrWVhCamIyMXdMbU5sY25RdVptNXRkQzVsY3k5RFRqMURVa3d4DQpMRTlWUFVGREpUSXdRMjl0Y0c5dVpXNTBaWE1sTWpCSmJtWnZjbTFoZEdsamIzTXNUejFHVGsxVUxWSkRUU3hEDQpQVVZUUDJObGNuUnBabWxqWVhSbFVtVjJiMk5oZEdsdmJreHBjM1E3WW1sdVlYSjVQMkpoYzJVL2IySnFaV04wDQpZMnhoYzNNOVkxSk1SR2x6ZEhKcFluVjBhVzl1VUc5cGJuU0dLV2gwZEhBNkx5OTNkM2N1WTJWeWRDNW1ibTEwDQpMbVZ6TDJOeWJITmpiMjF3TDBOU1RERXVZM0pzTUEwR0NTcUdTSWIzRFFFQkN3VUFBNElCQVFBRnVHRzk0ZGZBDQp0TlM2REJib25HMkNQV2NaYmFuMEhNK1pLSjBiSmV2Z2I4UnZHU2RwMGZXNTh4SmhObDVlcWM0aVdDT3JzLzR6DQpwZ2JiOEMzVlJYaDlndlJzTlQzWEUxV1FCVDBmUmI2Z2dUODRNRHVOcnFFT2NwNWduSndyditha1haZnZFbm9kDQpaTXRtYVBQQTZMcitRY0pRbWVGZnZoeUJEVkgwQzBiQ0Y5NzRldE5sN0Irb2laOEV0YlFVZjlvYm5BOThvdG1WDQpzN0lSN0ZOZVdnN1dJQ2ZhUzdGbzFkU2pTdGtYWDlwT1JmUk9CNHRsWHlTY2MvRm1xaytwUTVsbTlmSGs2MkZEDQo0OXpWNmlNN3VGL090Zml0YUp0cnJ0K3I1TTlrS2dLYStadkZNMDBRdVQzWDNDTEpUVEJycnhmTFI4L21XejhkDQpzdVk3VStWM2dpV1YNCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0NCg==';
    const validationResponse = {
      indication: 'TOTAL_PASSED',
      checks: ['credential', 'proof'],
      warnings: [],
      errors: [],
      reports: [
        {
          SimpleReport: {
            ValidationPolicy: {
              PolicyName: 'QES AdESQC TL based',
              PolicyDescription:
                "Validate electronic signatures and indicates whether they are Advanced electronic Signatures (AdES), AdES supported by a Qualified Certificate (AdES/QC) or a\n\t\tQualified electronic Signature (QES). All certificates and their related chains supporting the signatures are validated against the EU Member State Trusted Lists (this includes\n\t\tsigner's certificate and certificates used to validate certificate validity status services - CRLs, OCSP, and time-stamps).\n\t",
            },
            DocumentName: 'cades.pem',
            ValidSignaturesCount: 1,
            SignaturesCount: 1,
            ContainerType: null,
            signatureOrTimestamp: [
              {
                Signature: {
                  SigningTime: '2023-02-07T15:54:29Z',
                  BestSignatureTime: '2023-02-07T15:56:14Z',
                  SignedBy: 'SELLO COMPONENTE PRUEBAS EIDAS',
                  SignatureLevel: {
                    value: 'AdESeal-QC',
                    description:
                      'Advanced Electronic Seal supported by a Qualified Certificate',
                  },
                  SignatureScope: [
                    {
                      value: 'Full document',
                      Id: 'D-351FCAF07EDD007DE442FC6AEE426008241A66B85D9778E56F124A2876A2ADD7',
                      name: 'Full document',
                      scope: 'FULL',
                    },
                  ],
                  Timestamps: null,
                  Filename: null,
                  CertificateChain: {
                    Certificate: [
                      {
                        id: 'C-892FF7591AADD110E1EC4E80A8F63C8ABC6F36FCE2B29F0319BAE5AB3A7BD6F4',
                        qualifiedName: 'SELLO COMPONENTE PRUEBAS EIDAS',
                      },
                      {
                        id: 'C-F038421F07F20D63A20D3691E5A178AB8459EBE570C1647B7690554EF23876AB',
                        qualifiedName: 'FNMT-RCM',
                      },
                      {
                        id: 'C-EBC5570C29018C4D67B1AA127BAF12F703B4611EBC17B7DAB5573894179B93FA',
                        qualifiedName: 'FNMT-RCM',
                      },
                    ],
                  },
                  Indication: 'TOTAL_PASSED',
                  SubIndication: null,
                  AdESValidationDetails: null,
                  QualificationDetails: {
                    Error: [],
                    Warning: [
                      {
                        value:
                          'The private key does not reside in a QSCD at (best) signing time!',
                        Key: 'QUAL_QSCD_AT_ST_ANS',
                      },
                      {
                        value:
                          'The private key does not reside in a QSCD at issuance time!',
                        Key: 'QUAL_QSCD_AT_CC_ANS',
                      },
                    ],
                    Info: [],
                  },
                  Id: 'S-C827ED588908654B548B4B93D17B1E1A71B71232D898B441D1D4217A2CD6ACEA',
                  CounterSignature: null,
                  ParentId: null,
                  SignatureFormat: 'CAdES-BASELINE-B',
                  ExtensionPeriodMin: '2023-02-07T23:56:14Z',
                  ExtensionPeriodMax: '2023-10-17T08:36:54Z',
                },
              },
            ],
            Semantic: null,
            ValidationTime: '2023-02-07T15:56:14Z',
          },
        },
      ],
    };
    eidasValidator.validate.mockResolvedValue(validationResponse);
    const expectedResponse = {
      issuer: 'C=ES\nO=FNMT-RCM\nOU=AC Componentes Informáticos',
      subject:
        'C=ES\nL=MADRID\nO=FNMT-RCM PRUEBAS\nOU=CERES\nserialNumber=Q0000000J\norganizationIdentifier=VATES-Q0000000J\nCN=SELLO COMPONENTE PRUEBAS EIDAS',
      validFrom: Date.parse('2020-10-17T08:36:55.000Z'),
      validTo: Date.parse('2023-10-17T08:36:54.000Z'),
    };
    await expect(
      eidasValidationService.validate(verifiableCredentialDto),
    ).resolves.toEqual({
      valid: true,
      eidasCertInside: true,
      certInfo: expectedResponse,
      cert: expectedBase64Certificate,
    });
  });

  it('should not validate an eidas cert from a Verifiable Credential', async () => {
    const verifiableCredentialDto: VerifiableCredentialDto = {
      verifiableCredential: {
        '@context': ['https://www.w3.org/2018/credentials/v1'],
        id: 'https://example.com/credential/2390',
        type: ['VerifiableCredential', 'LargeFamilyCard'],
        issuer: 'did:ethr:0x5C6Ce5fB9Ce616507017eaA190659E771Aa2919e',
        issuanceDate: '2023-02-07T15:54:27.000Z',
        credentialSubject: {
          certificateBase64:
            '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',
          expirationDate: '09/06/2023 18:11:00',
          id: 'did:ethr:0xEeBBdDFCb5DF121e21d4526CF6b847eFaFc3ff81',
          issuerLegalID: '',
          issuerName: 'UANATACA CA1 2016',
          name: 'Joaquín López Cabezas',
          subjectLegalID: 'IDCES-03909546Y',
        },
        proof: [
          {
            type: 'EcdsaSecp256k1Signature2019',
            created: '2023-02-07T15:54:27.000Z',
            proofPurpose: 'assertionMethod',
            verificationMethod:
              'did:ethr:0x5C6Ce5fB9Ce616507017eaA190659E771Aa2919e#keys-1',
            jws: 'eyJhbGciOiJFUzI1NksiLCJraWQiOiJkaWQ6ZXRocjoweDVDNkNlNWZCOUNlNjE2NTA3MDE3ZWFBMTkwNjU5RTc3MUFhMjkxOWUja2V5cy0xIiwidHlwIjoiSldUIn0.eyJpYXQiOjE2NzU3ODUyNjcsImlzcyI6ImRpZDpldGhyOjB4NUM2Q2U1ZkI5Q2U2MTY1MDcwMTdlYUExOTA2NTlFNzcxQWEyOTE5ZSIsInZjIjp7IkBjb250ZXh0IjpbImh0dHBzOi8vd3d3LnczLm9yZy8yMDE4L2NyZWRlbnRpYWxzL3YxIl0sImNyZWRlbnRpYWxTdWJqZWN0Ijp7ImNlcnRpZmljYXRlQmFzZTY0IjoiTUlJSHVqQ0NCYUtnQXdJQkFnSUlPbnFiV3o2T3VoTXdEUVlKS29aSWh2Y05BUUVMQlFBd2diZ3hDekFKQmdOVkJBWVRBa1ZUTVVRd1FnWURWUVFIRER0Q1lYSmpaV3h2Ym1FZ0tITmxaU0JqZFhKeVpXNTBJR0ZrWkhKbGMzTWdZWFFnZDNkM0xuVmhibUYwWVdOaExtTnZiUzloWkdSeVpYTnpLVEVXTUJRR0ExVUVDZ3dOVlVGT1FWUkJRMEVnVXk1QkxqRVZNQk1HQTFVRUN3d01WRk5RTFZWQlRrRlVRVU5CTVJvd0dBWURWUVFEREJGVlFVNUJWRUZEUVNCRFFURWdNakF4TmpFWU1CWUdBMVVFWVF3UFZrRlVSVk10UVRZMk56SXhORGs1TUI0WERUSXhNRFl3T1RFMk1URXdNRm9YRFRJek1EWXdPVEUyTVRFd01Gb3dkVEVMTUFrR0ExVUVCaE1DUlZNeEZ6QVZCZ05WQkFRTURrekRzM0JsZWlCRFlXSmxlbUZ6TVJFd0R3WURWUVFxREFoS2IyRnhkY090YmpFWU1CWUdBMVVFQlJNUFNVUkRSVk10TURNNU1EazFORFpaTVNBd0hnWURWUVFEREJkS2IyRnhkY090YmlCTXc3TndaWG9nUTJGaVpYcGhjekNDQVNJd0RRWUpLb1pJaHZjTkFRRUJCUUFEZ2dFUEFEQ0NBUW9DZ2dFQkFJWVJKU1FGa09sL2tHNldKUmQrYnJGdFBsY2NWN1QrL050K0xod3NUa21uaENnZXVBMDVnWnZWUHMydUQ4K3IvejhWTHV4ODNPa2pNaGM0cEpNQ09TOFBxaThlSzdnc3kwWU9oWHYzaGpqSzBtaTlPKzc5NHNYRldET1ZEY1dOelp1T3Zjek9oMHhTSTVhN3hMejFubDJmVWlOUkh3amZtTGhZVSs4SUtyWVlMTjZtWThPdms4SHYxZlRUbmZPRHFkWmFBSEtFdWxzQlhUcFlCaEFMZndRRHowTUpIMzE4TG5valdDRXprTEdCaWU5TzVoSHhDWmZtbE0vdTZCLytpbG9EL0dZVWtKVGV3Uy9heVovWkllSlBzdVo0RUt6ZnZUZ1MyMHFoa0ZaT1pOZ2dnQ2wvMUlVWFk5Vm1UZlZXaS9zNDIybEdNNXYyMGNCTGYrcnRWU3NDQXdFQUFhT0NBd2d3Z2dNRU1JSFhCZ2dyQmdFRkJRY0JBUVNCeWpDQnh6QlZCZ2dyQmdFRkJRY3dBb1pKYUhSMGNEb3ZMM2QzZHk1MVlXNWhkR0ZqWVM1amIyMHZjSFZpYkdsakwyUnZkMjVzYjJGa0wzUnpjRjlqWlhKMGFXWnBZMkYwWlhNdmMzVmliM0prYVc1aGRHVXhMbU55ZERBMkJnZ3JCZ0VGQlFjd0FZWXFhSFIwY0RvdkwyOWpjM0F4TG5WaGJtRjBZV05oTG1OdmJTOXdkV0pzYVdNdmNHdHBMMjlqYzNBdk1EWUdDQ3NHQVFVRkJ6QUJoaXBvZEhSd09pOHZiMk56Y0RJdWRXRnVZWFJoWTJFdVkyOXRMM0IxWW14cFl5OXdhMmt2YjJOemNDOHdIUVlEVlIwT0JCWUVGUCtXcnBwSUUwV2dJajJsWCtvelgyTGtrajZXTUF3R0ExVWRFd0VCL3dRQ01BQXdId1lEVlIwakJCZ3dGb0FVTFhIdnNHTi85ZjNnZ3lKRWYwUVFNSUZQVGVVd1ZRWUlLd1lCQlFVSEFRTUVTVEJITUFnR0JnUUFqa1lCQVRBTEJnWUVBSTVHQVFNQ0FROHdMZ1lHQkFDT1JnRUZEQ1JvZEhSd2N6b3ZMM2QzZHk1MVlXNWhkR0ZqWVM1amIyMHZjSFZpYkdsakwyTndjeTh3Z2FFR0ExVWRJQVNCbVRDQmxqQUpCZ2NFQUl2c1FBRUFNSUdJQmdzckJnRUVBWUx4TmdFQkFUQjVNREFHQ0NzR0FRVUZCd0lCRmlSb2RIUndjem92TDNkM2R5NTFZVzVoZEdGallTNWpiMjB2Y0hWaWJHbGpMMk53Y3k4d1JRWUlLd1lCQlFVSEFnSXdPUXczUTJWeWRHbG1hV05oWkc4Z1kzVmhiR2xtYVdOaFpHOGdaR1VnVUdWeWMyOXVZU0JHdzYxemFXTmhJR1Z1SUhOdlpuUjNZWEpsTGpDQmp3WURWUjBmQklHSE1JR0VNRUNnUHFBOGhqcG9kSFJ3T2k4dlkzSnNNUzUxWVc1aGRHRmpZUzVqYjIwdmNIVmliR2xqTDNCcmFTOWpjbXd2UTBFeGMzVmliM0prYVc1aFpHRXVZM0pzTUVDZ1BxQThoanBvZEhSd09pOHZZM0pzTWk1MVlXNWhkR0ZqWVM1amIyMHZjSFZpYkdsakwzQnJhUzlqY213dlEwRXhjM1ZpYjNKa2FXNWhaR0V1WTNKc01BNEdBMVVkRHdFQi93UUVBd0lGNERBZEJnTlZIU1VFRmpBVUJnZ3JCZ0VGQlFjREFnWUlLd1lCQlFVSEF3UXdIZ1lEVlIwUkJCY3dGWUVUYW14alpXeHFkWE56UUdkdFlXbHNMbU52YlRBTkJna3Foa2lHOXcwQkFRc0ZBQU9DQWdFQU1ydVQ2OWFNSDBlMWFyeDQxWEwxcllvOVBVSHlwWjcwc0Q5TDJVNlJyTDFRYzY1Q0k1clVEQUpmTUtSMmZzR2NvNExUMU1KeGtEZyt0WCtmem5jYm12NVpIeHNuaG8wK1MvRGRMai91TnRHblU5ZjZtQjlLNjJIZWVFN2E5Q0o4cTFHejhac2xXNXhRcnZ0R2x5RmxmUWc2dDljQTJHNkVtL29YVWZtdzBiN2E3UE1SRlpIeDJWdXdGNmlTSS8ycXFJWVBhbU5UZWJqb0xaRHNqMys2WVczUVI5YUFHWEFXbGc3TEpvbktuc3pzUVF3Nml5SGxyUENlbTliQThNZG5aSlJPaktobm5HOC9OTmhub1dzNFhCMHh3WjBQMGV5YVdOVGh2WkRCNndGNmJEWWg4MnhyZ3dqUnRoN0ZndlhYdUlEQkk4U05TVDFyYUgzMEUzbUx0djdJSVl4dGxNMUx2aXh5ZFFMb08wN2dWNVBhNmY4eTB3RWU5VG9GbVgvOVcyUmhDQW5mOExHMEx1Q3VEMWEvUFFzelk3TzV3YkRxemsyclM4NHVJcXJFQzhWenQvVU03SjZHSm9QVTN4bmQvWWV6TXE0bDk4UXN2RmdkbDhQUXVXei9Yd05ZKytla1FkMmVpS2tXTUF3dWpHSGtEZGJxVjhMeWxVNG1mTVRVSUxlZWRLd0MzckpYY1dqRGhIRlB6a01uWHI1dTdtYTIwSk9yRHlWY1UyMWVTS3J3V3lTWG1uVkVhbWpZeThNeHlIMDBsQ250b0lNYjgvYmFtZzV1aEhXL09vS0tXRWhtWUd0Y21SVVpvcjVKME81WnNadWpON1htQ1AyMlJZdVF0VkM0dEloTkxyN1FRQW83blZlVkJtdlVVazNCK0hKaDhEWHladmhPN05zPSIsImV4cGlyYXRpb25EYXRlIjoiMDkvMDYvMjAyMyAxODoxMTowMCIsImlkIjoiZGlkOmV0aHI6MHhFZUJCZERGQ2I1REYxMjFlMjFkNDUyNkNGNmI4NDdlRmFGYzNmZjgxIiwiaXNzdWVyTGVnYWxJRCI6IiIsImlzc3Vlck5hbWUiOiJVQU5BVEFDQSBDQTEgMjAxNiIsIm5hbWUiOiJKb2FxdcOtbiBMw7NwZXogQ2FiZXphcyIsInN1YmplY3RMZWdhbElEIjoiSURDRVMtMDM5MDk1NDZZIn0sImlkIjoiaHR0cHM6Ly9leGFtcGxlLmNvbS9jcmVkZW50aWFsLzIzOTAiLCJpc3N1ZXIiOiJkaWQ6ZXRocjoweDVDNkNlNWZCOUNlNjE2NTA3MDE3ZWFBMTkwNjU5RTc3MUFhMjkxOWUiLCJ0eXBlIjpbIlZlcmlmaWFibGVDcmVkZW50aWFsIiwiTGFyZ2VGYW1pbHlDYXJkIl19fQ.xAeMomAiC6q_m3pLKosUTZcWc9xDNx5dlN7uHGfGAbCfvACrn--XNXV2A9jauho4Wj1jvpEDLUILYk-064Xj1g',
          },
          {
            type: 'CAdESRSASignature2020',
            created: '2023-02-07T15:54:28Z',
            proofPurpose: 'assertionMethod',
            verificationMethod:
              'did:ethr:0x5C6Ce5fB9Ce616507017eaA190659E771Aa2919e#MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAziPjJZebqdAhKZI0zUqd7439PGAlGY/MEIYl/hd0f3paG6UNcnQr74mzkOsJblSTcfzWCPefqWDQ1L/jQ0Iz1gR47I5l+sW7bBRivs1iWON6bcRXuitmVXFJPTl+R6x5vcEcOYlrKq0Fo9fEgbHb5i7Hjl0nWSOLcFsFkgSXfgmv3eI4uYlQyqs6qyICpApcWrijjIRlBlhsbv6Oz0Z8yi0v8FvgEy7Dq40yIoY3IWEGB8GNgi/E3lnLSRsGvzTWT5SXuurSzxrArh2okcNwtAt9DRF3VtMBO701zC2rfI65VyoIKX4QvctGiLSNOSYajDJ9Jg6GjnlE/US0Z6hyDwIDAQAB',
            cades:
              '-----BEGIN PKCS7-----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-----END PKCS7-----',
          },
        ],
      },
    };

    const validationResponse = {
      indication: 'TOTAL_FAILED',
      checks: ['credential', 'proof'],
      warnings: [],
      errors: ['{"message":"TOTAL_FAILED: Error on verifying signature"}'],
    };
    eidasValidator.validate.mockResolvedValue(validationResponse);
    await expect(
      eidasValidationService.validate(verifiableCredentialDto),
    ).resolves.toEqual({
      valid: false,
      eidasCertInside: true,
      error: validationResponse.errors,
    });
  });
});
